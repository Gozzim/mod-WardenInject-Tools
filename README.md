# This is a module for  ![logo](https://raw.githubusercontent.com/azerothcore/azerothcore.github.io/master/images/logo-github.png) AzerothCore
## WIP: WardenInject Tools
[![core-build](https://github.com/Gozzim/mod-WardenInject-Tools/actions/workflows/core-build.yml/badge.svg?branch=master)](https://github.com/Gozzim/mod-WardenInject-Tools)
[![core-version](https://img.shields.io/badge/core--rev-67bbeb7-ff0000.svg?labelColor=2e2c2c&logo=data:image/png;base64,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)](https://github.com/azerothcore/azerothcore-wotlk/commit/67bbeb7d6fa1d97e62887ae58c2e82796a286e40)
[![CodeFactor](https://www.codefactor.io/repository/github/gozzim/mod-wardeninject-tools/badge)](https://www.codefactor.io/repository/github/gozzim/mod-wardeninject-tools)

## Description

**Warning**: Do not set config `NumLuaChecks` > 1 right now, as this causes a weird behavior

## Requirements

Requires at least revision [azerothcore-wotlk@67bbeb7](https://github.com/azerothcore/azerothcore-wotlk/commit/67bbeb7d6fa1d97e62887ae58c2e82796a286e40) of AzerothCore

## ToDo List
* [x] Warden Packet Injection Initialization
  * [x] Inject primary helper functions for communication and execution
  * [x] Inject functions to handle addon injection
  * [x] Inject configured payloads
* [ ] Implement injection from file
  * [x] File loading as payload
  * [x] Load file from set ScriptPath or root depending on start of path string
  * [ ] Add name for ScriptFiles in Data
  * [ ] Add Path for ScriptFiles in Data
  * [ ] Implement file reformatting for injection
    * [x] Remove leading spaces
    * [x] Remove trailing spaces
    * [x] Remove empty lines
    * [x] Remove line breaks
    * [ ] Remove comments (still buggy)
* [ ] Payload Management
  * [x] Injection to handle payloads
  * [x] Chunk large payloads into multiple packets
  * [x] Compression
    * [x] LZW Implementation
    * [x] Adjustment for WardenInjection
  * [x] Payload Storage
* [x] Event Handling
  * [x] OnLogin: Initialize Injection
  * [x] OnReload: Reinitialize Injection
  * [x] Handle Script Injection requests
* [ ] Caching
  * [ ] Server-side
  * [ ] Client-side
* [ ] Commands
  * [x] Command for code injection
  * [x] Command for file injection
  * [x] Command for preloaded Script injection
  * [x] Various debugging commands
  * [ ] Command to reload and notify players to relad UI
  * [ ] Command to check available payloads in Store
  * [ ] Command to check available payloads in `ScriptsPath`
  * [ ] DB query for commmands table
* [ ] Implement config
  * [x] Config to enable addon injection initialization onLogin
  * [x] Config client cache table location
  * [x] Config to load scripts for injection dynamically
  * [x] Config for default script path
  * [ ] Config for forced checks
  * [ ] Config for verbose output
  * [ ] Debug client-side
  * [ ] Prefix for addon injection
  * [x] Default path script to {source}/modules/mod-WardenInject-Tools/payloads
* [x] Example Files
  * [x] AIO and Dependencies
  * [x] Example payload
* [ ] Optimize Loading Order
* [ ] Debug Logging
* [ ] Cleanup Imports and Code
* [x] Move FileManagement Functions to WardenInjectFileMgr
* [ ] Document Code

Known Bugs:
* `Saved Variables` do not work as intended
* Eluna Scripts are not executed or even received after Client AIO was injected

## Config


## Commands

## Installation
```
1) Simply place the module under the `modules` directory of your AzerothCore source. 
2) Re-run cmake and launch a clean build of AzerothCore.
```

## Credits
- Module for AzerothCore created by [Gozzim](https://github.com/Gozzim)
- Based on [WardernInject](https://github.com/Foereaper/WardenInject) by [Foereaper](https://github.com/Foereaper)
- [LZW Algorithm](https://github.com/Rochet2/lualzw) by [Rochet2](https://github.com/Rochet2)
- AzerothCore: [repository](https://github.com/azerothcore) - [website](http://azerothcore.org/)

## License
This code and content is released under the [GNU AGPL 3.0 license](https://github.com/Gozzim/mod-WardenInject-Tools/blob/master/LICENSE).
